{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["class Observer {\r\n    constructor(data) {\r\n        // Object.defineProperty只能劫持已经存在的属性（vue里面会为此单独写一些api如$set $detele）\r\n        this.walk(data)\r\n    }\r\n\r\n    // 循环对象 对属性依次劫持\r\n    walk(data) {\r\n        Object.keys(data).forEach(key => defineReactive(data, key, data[key]))\r\n    }\r\n}\r\n\r\nexport function defineReactive(target, key, value) {\r\n    observe(value)\r\n    Object.defineProperty(target, key, {\r\n        get() {\r\n            return value\r\n        },\r\n        set(newValue) {\r\n            if (newValue === value) return\r\n            value = newValue\r\n        }\r\n    })\r\n}\r\n\r\n\r\nexport function observe(data) {\r\n    // 对对象进行劫持\r\n    if (typeof data !== 'object' || data == null) {\r\n        return\r\n    }\r\n    // 若被劫持就不需要被劫持\r\n\r\n    return new Observer(data)\r\n}","import { observe } from \"./observe/index\"\r\n\r\nexport default function initState(vm) {\r\n    const opts = vm.$options\r\n    if (opts.data) {\r\n        initData(vm)\r\n    }\r\n}\r\n\r\nfunction initData(vm) {\r\n    let data = vm.$options.data  // data可能是函数也可能是对象\r\n    data = typeof data === 'function' ? data.call(vm) : data\r\n    vm._data = data\r\n    // 对数据进行劫持\r\n    observe(data)\r\n\r\n    // 将vm._data用vm来代理\r\n    for (let key in data) {\r\n        proxy(vm, '_data', key)\r\n    }\r\n}\r\n\r\nfunction proxy(vm, target, key) {\r\n    Object.defineProperty(vm, key, {\r\n        get() {\r\n            return vm[target][key]\r\n        },\r\n\r\n        set(newValue) {\r\n            vm[target][key] = newValue\r\n        }\r\n    })\r\n}","import initState from \"./state\"\r\n\r\nexport function initMixin(Vue) { // 给Vue增加init方法\r\n    Vue.prototype._init = function (options) { //初始化操作\r\n        const vm = this\r\n\r\n        // 挂载用户的配置到示例的$options属性上\r\n        vm.$options = options\r\n\r\n        // 初始化状态\r\n        initState(vm)\r\n    }\r\n}\r\n\r\n\r\n","// vue不用class是因为所有方法都耦合在一起，不好管理\r\n\r\nimport { initMixin } from \"./init\"\r\n\r\nfunction Vue(options) {\r\n    this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\n\r\nexport default Vue"],"names":["Observer","data","walk","Object","keys","forEach","key","defineReactive","target","value","observe","defineProperty","get","set","newValue","initState","vm","opts","$options","initData","call","_data","proxy","initMixin","Vue","prototype","_init","options"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAAMA,QAAQ;IACV,kBAAYC,IAAI,EAAE;MAAA;;MAEd,IAAI,CAACC,IAAI,CAACD,IAAI,CAAC;;;;IAGnB;MAAA;MAAA,OACA,cAAKA,IAAI,EAAE;QACPE,MAAM,CAACC,IAAI,CAACH,IAAI,CAAC,CAACI,OAAO,CAAC,UAAAC,GAAG;UAAA,OAAIC,cAAc,CAACN,IAAI,EAAEK,GAAG,EAAEL,IAAI,CAACK,GAAG,CAAC,CAAC;UAAC;;;IACzE;EAAA;EAGE,SAASC,cAAc,CAACC,MAAM,EAAEF,GAAG,EAAEG,KAAK,EAAE;IAC/CC,OAAO,CAACD,KAAK,CAAC;IACdN,MAAM,CAACQ,cAAc,CAACH,MAAM,EAAEF,GAAG,EAAE;MAC/BM,GAAG,iBAAG;QACF,OAAOH,KAAK;OACf;MACDI,GAAG,eAACC,QAAQ,EAAE;QACV,IAAIA,QAAQ,KAAKL,KAAK,EAAE;QACxBA,KAAK,GAAGK,QAAQ;;KAEvB,CAAC;EACN;EAGO,SAASJ,OAAO,CAACT,IAAI,EAAE;;IAE1B,IAAI,QAAOA,IAAI,MAAK,QAAQ,IAAIA,IAAI,IAAI,IAAI,EAAE;MAC1C;;;;IAIJ,OAAO,IAAID,QAAQ,CAACC,IAAI,CAAC;EAC7B;;EChCe,SAASc,SAAS,CAACC,EAAE,EAAE;IAClC,IAAMC,IAAI,GAAGD,EAAE,CAACE,QAAQ;IACxB,IAAID,IAAI,CAAChB,IAAI,EAAE;MACXkB,QAAQ,CAACH,EAAE,CAAC;;EAEpB;EAEA,SAASG,QAAQ,CAACH,EAAE,EAAE;IAClB,IAAIf,IAAI,GAAGe,EAAE,CAACE,QAAQ,CAACjB,IAAI;IAC3BA,IAAI,GAAG,OAAOA,IAAI,KAAK,UAAU,GAAGA,IAAI,CAACmB,IAAI,CAACJ,EAAE,CAAC,GAAGf,IAAI;IACxDe,EAAE,CAACK,KAAK,GAAGpB,IAAI;;IAEfS,OAAO,CAACT,IAAI,CAAC;;;IAGb,KAAK,IAAIK,GAAG,IAAIL,IAAI,EAAE;MAClBqB,KAAK,CAACN,EAAE,EAAE,OAAO,EAAEV,GAAG,CAAC;;EAE/B;EAEA,SAASgB,KAAK,CAACN,EAAE,EAAER,MAAM,EAAEF,GAAG,EAAE;IAC5BH,MAAM,CAACQ,cAAc,CAACK,EAAE,EAAEV,GAAG,EAAE;MAC3BM,GAAG,iBAAG;QACF,OAAOI,EAAE,CAACR,MAAM,CAAC,CAACF,GAAG,CAAC;OACzB;MAEDO,GAAG,eAACC,QAAQ,EAAE;QACVE,EAAE,CAACR,MAAM,CAAC,CAACF,GAAG,CAAC,GAAGQ,QAAQ;;KAEjC,CAAC;EACN;;EC9BO,SAASS,SAAS,CAACC,GAAG,EAAE;;IAC3BA,GAAG,CAACC,SAAS,CAACC,KAAK,GAAG,UAAUC,OAAO,EAAE;;MACrC,IAAMX,EAAE,GAAG,IAAI;;;MAGfA,EAAE,CAACE,QAAQ,GAAGS,OAAO;;;MAGrBZ,SAAS,CAACC,EAAE,CAAC;KAChB;EACL;;ECZA;EAIA,SAASQ,GAAG,CAACG,OAAO,EAAE;IAClB,IAAI,CAACD,KAAK,CAACC,OAAO,CAAC;EACvB;EAEAJ,SAAS,CAACC,GAAG,CAAC;;;;;;;;"}